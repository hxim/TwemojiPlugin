<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0" />
		<style>
            * { border-style: solid; border-width: 0; }
			body {  background-color:#474747; overflow: hidden; margin: 3px 8px 0 8px; text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.45); }
            body, button, input, textarea, select, label { font-family: "Open Sans", Sans-Serif; font-size: 13px; color: #d5d5d5; vertical-align: top; }
			label { line-height:21px; display: inline-block; margin-top: 2px; user-select: none; width: 44px; }
            input { background-color: #252525; border-radius: 3px; padding: 3px; box-sizing: border-box; margin: 1px; line-height: 17.5px; height: 23px; }
            input[type="checkbox"] { margin: 1px 5px 1px 1px; vertical-align: middle; background-color: white; opacity: 0.8; }
            input[type="number"] { width: 68px; }
            input[type="color"] { margin: 1px; background-color: #252525; width: 44px; padding: revert; }
            button.objbutton { margin: 1px; width: 44px; height: 23px; }
            select { background-color: #606060; padding: 2px 15px 3px 5px; width: 150px; margin: 1px; overflow: hidden;
                     background-image: linear-gradient(45deg, transparent 50%, #d5d5d5 50%), linear-gradient(135deg, #d5d5d5 50%, transparent 50%);
                     background-position: calc(100% - 9px) calc(10px), calc(100% - 4px) calc(10px); background-size: 5px 5px, 5px 5px;
                     background-repeat: no-repeat; -webkit-appearance: none; line-height: 1.5em;
            }
            select, #cont a { border-radius: 3px; border-top-width: 1px; border-top-color: rgba(255, 255, 255, 0.15); border-bottom-width: 1px; border-bottom-color: rgba(0, 0, 0, 0.6); }
            button { padding: 2px 5px 3px 5px; border-radius: 3px; background-color: #606060; border-top-width: 1px; border-top-color: rgba(255, 255, 255, 0.15); border-bottom-width: 1px;
                     border-bottom-color: rgba(0, 0, 0, 0.6); overflow: hidden; text-align: center; white-space: nowrap; user-select: none; cursor: default; line-height: 17.5px; height: 26px;
                     margin: 1px; }
			.ew {  background-color: #474747; position: relative; width: 100%; height: 100%; }
            .ew > div { width: 100% !important; height: 100% !important; }
            .ew svg { width: 100%; height: 100%; }
		    select:hover, a:hover, button:hover { background-color: #6a6a6a; }
            #cont a { font-size: 13px; color: #d5d5d5; background-color: #606060; display: inline-block; line-height: 20.5px; height: 20.5px; width: 140px; vertical-align: top; text-decoration: none; padding: 2px; text-align: center; margin: 5px auto; position: absolute; left: 0; right: 0; }
            #margin { width: 50px; }
            #topbar { height: 103px; white-space: nowrap; position: relative; }
			#cont { position: relative; font-size: 16px; }
            #cont > div { position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: 0 auto; }
            #data { margin: 0; background-color: #252525; border-radius: 3px; width: 100%; box-sizing: border-box; padding: 4px; resize: none; }
            #splitter { cursor: ns-resize; margin: 0; padding: 0; height: 6px; }

        #win { position: absolute; z-index: 10; background-color: #474747; top: 32px; left: 0px; right: 0px; bottom: 0px; box-shadow: 0px 8px 40px rgba(0,0,0,0.2); display: none; max-width: 400px;}
        #win > .head { font-size: 1.3em; color: #ffffff; background: linear-gradient(to bottom, #595959 0%,#626262 3%,#575757 7%,#3c3c3c 90%,#3a3a3a 97%,#2e2e2e 100%); background-size: auto 100%; height: 33px; user-select: none; }
        #win > .head .label { display: inline-block; padding: 0.3em 0.5em; text-shadow: 0 -1px 0 rgba(0,0,0,0.45); font-weight: bold; }
        #win > .head .label { display: inline-block; padding: 0.3em 0.5em; text-shadow: 0 -1px 0 rgba(0,0,0,0.45); font-weight: bold; }
        #win > .head .cross { width: 0.8em; height: 0.8em; display: inline-block; background-size: cover; font-size: 1.3em; margin: 0.3em; position: absolute; right: 0; cursor: pointer; filter: invert(1); background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTYgMjU2IiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTIuMDkgMzguNUw5MSAxMjcuNUwxLjkxIDIxNi41TDM5LjUgMjUyLjg2TDEyOCAxNjQuNUwyMTcuNSAyNTQuMDFMMjU0LjA2IDIxNy41TDE2NS4xNiAxMjcuNUwyNTUuMDEgMzcuNUwyMTguNDkgMUwxMjcuODQgOTAuNUwzOC40OSAwLjg1TDIuMDkgMzguNVoiIC8+PC9zdmc+); }
        #win > .body { padding: 6px; overflow-y: auto; scrollbar-color: #222222 rgba(0,0,0,0.2); scrollbar-width: thin; height: calc(100% - 78px); }
        #win .body label { width: calc(50% - 2px); }
        #win .body select, #win .body input[type="number"], #win .body input[type="text"] { width: calc(50% - 2px); }
        #win .body  input.colortext[type="text"], #win .body  input.objtext[type="text"] { width: calc(50% - 48px); }
        #win .body a { color: #d5d5d5; }
        #win .body a:hover { background-color: #333333; }
        #win .body label.pad { padding-left: 18px; width: calc(50% - 20px); }
        #win .body label.arr { cursor: pointer;  width: calc(100% - 20px); }
        #win .body label.arr.open   { background-image: linear-gradient(45deg, transparent 50%, #d5d5d5 50%), linear-gradient(135deg, #d5d5d5 50%, transparent 50%);
                                    background-position: calc(1px) calc(8px), calc(6px) calc(8px); background-size: 5px 5px, 5px 5px; background-repeat: no-repeat; }
        #win .body label.arr.closed { background-image: linear-gradient(225deg, transparent 50%, #d5d5d5 50%), linear-gradient(135deg, #d5d5d5 50%, transparent 50%);
                                    background-position: calc(4px) calc(6px), calc(4px) calc(11px); background-size: 5px 5px, 5px 5px; background-repeat: no-repeat; }
        #win .body hr { background-color: #252525; height: 1px; }
        #win .body .hidden { display: none; }
        #editorbody button { min-width: 30px; }
        #editorbody button[disabled], #editorbody button[disabled]:hover { background-color: #606060; color: #8e8e8e; pointer-events: none; }
    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(function() { loadstate(); update(); });
      function drawChart(elem, chtype, data, hasLabels, options, readyHandler) {
        var chart = new google.visualization[chtype](elem);
        google.visualization.events.addListener(chart, 'ready', readyHandler);
        chart.draw(google.visualization.arrayToDataTable(data, !hasLabels), options);
      }

    function drawError(elem, message) {
        var err1 = document.createElement("div"); err1.id = 'google-visualization-errors-all-1'; err1.style = 'display: block; padding-top: 2px;';
        var err2 = document.createElement("div"); err2.id = 'google-visualization-errors-all-0'; err2.style = 'font: 0.8em arial, sans-serif; margin-bottom: 5px;';
        var err3 = document.createElement("span"); err3.style = 'background-color: rgb(192, 0, 0); color: white; padding: 2px;';
        var err4 = document.createElement("span"); err4.style = 'font-size: 1.1em; font-weight: bold; cursor: pointer; padding-left: 10px; color: black; text-align: right; vertical-align: top;'
        err4.onclick = function() { err1.removeChild(err2); }
        err4.appendChild(document.createTextNode("Ã—"));
        err3.appendChild(document.createTextNode(message));
        err3.appendChild(err4);
        err2.appendChild(err3);
        err1.appendChild(err2);
        elem.insertBefore(err1, elem.firstChild);
    }
    function clearElement(id) {
        var element = document.getElementById(id);
        while (element.firstChild) element.removeChild(element.firstChild);
        return element;
    }
    function insertImage(svgElement) {
        var dataURI =  'data:image/svg+xml,' + encodeURIComponent(svgElement.outerHTML.trim());
        if (window.parent == window.self) {
            if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) { alert('not supported in IE.'); return; }
            var element = document.createElement('a');
            element.setAttribute('href', dataURI);
            element.setAttribute('download', 'chart.svg');
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        } else {
            window.parent.postMessage('app.open("' + dataURI + '", null, false)', '*');
        }
    }
    function setsize() {
        var ratio = document.getElementById("cont").firstChild.getBoundingClientRect().height/document.getElementById("data").getBoundingClientRect().height;
        var width = Math.max(268, window.innerWidth - 16);
        var height = Math.max(128, window.innerHeight - 148), hdata = 1 + ratio == 0 ? height / 2 : height / (1 + ratio);
        var min = 40;
        if (hdata < min) hdata = min; else if (height-hdata < min) hdata = height - min;
        document.getElementById("title").setAttribute("style","width:"+(width-44)+"px;");
        document.getElementById("data").setAttribute("style","width:"+(width)+"px;height:"+(hdata)+"px;");
        document.getElementById("cont").setAttribute("style","height:"+(height+26)+"px;");
        document.getElementById("c2").setAttribute("style","width:"+(width)+"px;height:"+(height-hdata)+"px;");
        var optionssize = function() { if (document.getElementById("win").display != "none" && document.getElementById("win").style.height != "") document.getElementById("win").style.height = (document.body.getBoundingClientRect().height-document.getElementById("cont").getBoundingClientRect().height-35) + "px"; }
        optionssize();
        document.getElementById("splitter").onmousedown = function() { splitterMouseDown(event,"data","c2", min, optionssize); }

    }
    function splitterMouseDown(e, id1, id2, min, func) {
        var elem = [document.getElementById(id1), document.getElementById(id2)];
        var md = e, h = [elem[0].offsetHeight, elem[1].offsetHeight];
        document.onmousemove = function(e) {
            var d = Math.min(Math.max(e.clientY - md.clientY, -h[0] + min), h[1] - min);
            elem[0].style.height = (h[0] + d) + "px";
            elem[1].style.height = (h[1] - d) + "px";
            func();
            e.preventDefault();
        };
        document.onmouseup = function() { document.onmousemove = document.onmouseup = null; }
    }
    function generateOptions() {
        const optionsDef = "s;aggregationTarget;1705;auto;category,series,auto,none|b;annotations.alwaysOutside;18|o;annotations.boxStyle;691;;cStroke,nStrokeWidth,nRx,nRy,cGradient.color1,cGradient.color2,sGradient.x1,sGradient.y1,sGradient.x2,sGradient.y2,0Gradient.useObjectBoundingBoxUnits|o;annotations.datum;691;;cStem.color,nStem.length,sStyle+line+point|o;annotations.domain;691;;cStem.color,nStem.length,sStyle+line+point|b;annotations.highContrast;691;true|o;annotations.stem;691;;cColor,nLength|s;annotations.style;691;point;line,point|o;annotations.textStyle;691;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|n;areaOpacity;1057;0.3;0.01|s;axisTitlesPosition;1791;out;in,out,none|c;backgroundColor.fill;2047;white|c;backgroundColor.stroke;2047;#666|n;backgroundColor.strokeWidth;2047;0|s;bar.groupWidth;122;61.8%|s;bars;18;vertical;horizontal,vertical|n;bubble.opacity;4;0.8;0.1|c;bubble.stroke;4;#ccc|o;bubble.textStyle;4;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|s;candlestick.fallingColor.fill;40;auto|s;candlestick.fallingColor.stroke;40;auto|n;candlestick.fallingColor.strokeWidth;40;2|b;candlestick.hollowIsRising;40|s;candlestick.risingColor.fill;40;auto|s;candlestick.risingColor.stroke;40;auto|n;candlestick.risingColor.strokeWidth;40;2|c;chartArea.backgroundColor;2047;white|s;chartArea.height;2047|s;chartArea.left;2047|s;chartArea.top;2047|s;chartArea.width;2047|a;colorAxis.colors;4;;cColor|s;colorAxis.legend.numberFormat;4|s;colorAxis.legend.position;4;top;top,bottom,in,none|o;colorAxis.legend.textStyle;4;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|n;colorAxis.maxValue;4|n;colorAxis.minValue;4|a;colorAxis.values;4;;nValue|a;colors;2047;;cColor|b;connectSteps;1024;true|c;crosshair.color;673|o;crosshair.focused;673;;cColor,dOpacity,sOrientation+vertical+horizontal+both|n;crosshair.opacity;673;1.0;0.01|s;crosshair.orientation;673;both;vertical,horizontal,both|o;crosshair.selected;673;;cColor,dOpacity,sOrientation+vertical+horizontal+both|s;crosshair.trigger;673;both;focus,selection,both|s;curveType;672;none;none,function|n;dataOpacity;755;1.0;0.01|b;enableInteractivity;2047;true|s;focusTarget;1275;datum;datum,category|s;fontName;2047;Arial|n;fontSize;2047|a;hAxes;2;;nBaseline,cBaselineColor,sDirection,sFormat,cGridlines.color,nGridlines.count,nGridlines.interval,nGridlines.minSpacing,nGridlines.multiple,oGridlines.units,0LogScale,nMaxValue,nMinValue,cMinorGridlines.color,nMinorGridlines.count,nMinorGridlines.interval,nMinorGridlines.minSpacing,nMinorGridlines.multiple,oMinorGridlines.units,sScaleType+log+mirrorLog,sTextPosition+out+in+none,oTextStyle,oTicks,sTitle,oTitleTextStyle,nViewWindow.max,nViewWindow.min,sViewWindowMode+pretty+maximized+explicit|b;hAxis.allowContainerBoundaryTextCutoff;1273|n;hAxis.baseline;703|c;hAxis.baselineColor;703;black|s;hAxis.direction;1727;1|s;hAxis.format;703|c;hAxis.gridlines.color;767;#CCC|n;hAxis.gridlines.count;767|n;hAxis.gridlines.interval;249|n;hAxis.gridlines.minSpacing;249|n;hAxis.gridlines.multiple;249;1|o;hAxis.gridlines.units;767;;sYears.format,sMonths.format,sDays.format,sHours.format,sMinutes.format,sSeconds.format,sMiliseconds.format|b;hAxis.logScale;703|n;hAxis.maxAlternation;1273;2|n;hAxis.maxTextLines;1273|n;hAxis.maxValue;703|n;hAxis.minTextSpacing;1273|n;hAxis.minValue;703|c;hAxis.minorGridlines.color;767|n;hAxis.minorGridlines.count;767|n;hAxis.minorGridlines.interval;249|n;hAxis.minorGridlines.minSpacing;249|n;hAxis.minorGridlines.multiple;249;1|o;hAxis.minorGridlines.units;767;;sYears.format,sMonths.format,sDays.format,sHours.format,sMinutes.format,sSeconds.format,sMiliseconds.format|s;hAxis.scaleType;703;;,log,mirrorLog|n;hAxis.showTextEvery;1273|b;hAxis.slantedText;1273|n;hAxis.slantedTextAngle;1273;30|s;hAxis.textPosition;1791;out;out,in,none|o;hAxis.textStyle;1791;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|a;hAxis.ticks;1727;;oV,sF|s;hAxis.title;1791|o;hAxis.titleTextStyle;1791;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|n;hAxis.viewWindow.max;1791|n;hAxis.viewWindow.min;1791|s;hAxis.viewWindowMode;767;;,pretty,maximized,explicit|n;histogram.bucketSize;64|b;histogram.hideBucketItems;64|n;histogram.lastBucketPercentile;64;0|n;histogram.maxValue;64|n;histogram.minValue;64|s;histogram.numBucketsRule;64;sqrt;sqrt,sturges,rice|b;interpolateNulls;225|b;is3D;256|b;isStacked;1139|s;legend.alignment;2047;;,start,center,end|n;legend.maxLines;2029;1|n;legend.pageIndex;767;0|s;legend.position;2047;right;bottom,left,in,none,right,top,labeled|o;legend.textStyle;2047;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|a;lineDashStyle;1185;;nLength|n;lineWidth;673|s;orientation;763;;,horizontal,vertical|n;pieHole;256;0;0.01|c;pieResidueSliceColor;256;#ccc|s;pieResidueSliceLabel;256;Other|c;pieSliceBorderColor;256;white|s;pieSliceText;256;percentage;percentage,value,label,none|o;pieSliceTextStyle;256;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|n;pieStartAngle;256;0|s;pointShape;673;circle;circle,triangle,square,diamond,star,polygon|n;pointSize;673|b;pointsVisible;673;true|b;reverseCategories;1531|s;selectionMode;1709;single;single,multiple|a;series;1791;;oAnnotations,dAreaOpacity,cColor,sLabelInLegend,oLineDashStyle,nLineWidth,sPointShape+circle+triangle+square+diamond+star+polygon,nPointSize,1PointsVisible,nTargetAxisIndex,1VisibleInLegend|s;seriesType;32;line;line,area,bars,candlesticks,steppedArea|n;sizeAxis.maxSize;4;30|n;sizeAxis.maxValue;4|n;sizeAxis.minSize;4;5|n;sizeAxis.minValue;4|n;sliceVisibilityThreshold;256;0.0014;0.0001|a;slices;256;;cColor,dOffset,sTextStyle.FontName,nTextStyle.FontSize,bTextStyle.Bold,bTextStyle.Italic,cTextStyle.Color,cTextStyle.AuraColor,dTextStyle.Opacity|b;sortBubblesBySize;4;true|s;theme;1791;;,maximized|s;titlePosition;1791;out;in,out,none|o;titleTextStyle;2047;;sFontName,nFontSize,1Bold,0Italic,cColor,cAuraColor,dOpacity|b;tooltip.ignoreBounds;1979|b;tooltip.isHtml;2047|b;tooltip.showColorCode;2043|s;tooltip.text;256;both;both,value,percentage|o;tooltip.textStyle;2047;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|s;tooltip.trigger;2047;focus;focus,none,selection|a;trendlines;658;;cColor,nDegree,sLabelInLegend,nLineWidth,dOpacity,nPointSize,1PointsVisible,0ShowR2,sType+linear+exponential+polynomial,0VisibleInLegend|a;vAxes;1273;;nBaseline,cBaselineColor,sDirection,sFormat,cGridlines.color,nGridlines.count,nGridlines.interval,nGridlines.minSpacing,nGridlines.multiple,oGridlines.units,0LogScale,nMaxValue,nMinValue,cMinorGridlines.color,nMinorGridlines.count,nMinorGridlines.interval,nMinorGridlines.minSpacing,nMinorGridlines.multiple,oMinorGridlines.units,sScaleType+log+mirrorLog,sTextPosition+out+in+none,oTextStyle,oTicks,sTitle,oTitleTextStyle,nViewWindow.max,nViewWindow.min,sViewWindowMode+pretty+maximized+explicit|n;vAxis.baseline;1791|c;vAxis.baselineColor;1791;black|s;vAxis.direction;1791;1|s;vAxis.format;1791|c;vAxis.gridlines.color;1791;#CCC|n;vAxis.gridlines.count;1791|n;vAxis.gridlines.interval;249|n;vAxis.gridlines.minSpacing;249|n;vAxis.gridlines.multiple;249;1|o;vAxis.gridlines.units;767;;sYears.format,sMonths.format,sDays.format,sHours.format,sMinutes.format,sSeconds.format,sMiliseconds.format|b;vAxis.logScale;767|n;vAxis.maxValue;1791|n;vAxis.minValue;1791|c;vAxis.minorGridlines.color;1791|n;vAxis.minorGridlines.count;1791|n;vAxis.minorGridlines.interval;1|n;vAxis.minorGridlines.minSpacing;249|n;vAxis.minorGridlines.multiple;249;1|o;vAxis.minorGridlines.units;248;;sYears.format,sMonths.format,sDays.format,sHours.format,sMinutes.format,sSeconds.format,sMiliseconds.format|s;vAxis.scaleType;1791;;,log,mirrorLog|s;vAxis.textPosition;1791;out;out,in,none|o;vAxis.textStyle;1791;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|a;vAxis.ticks;1791;;oV,sF|s;vAxis.title;1791|o;vAxis.titleTextStyle;1791;;sFontName,nFontSize,0Bold,0Italic,cColor,cAuraColor,dOpacity|n;vAxis.viewWindow.max;1791|n;vAxis.viewWindow.min;1791|s;vAxis.viewWindowMode;1791;;,pretty,maximized,explicit";
        var optionsDef2 = optionsDef.split('|'), cgroup = '', cgrouppos = -1, optionsDef3 = [];
        function compGroupBits(start, end) {
            var b = 0;
            for (var j = start; j <= end; j++) b |= parseInt(optionsDef3[j].split(';')[2]);
            return b;
        }
        for (var i = 0; i < optionsDef2.length; i++) {
            var a1 = optionsDef2[i].split(';')[1];
            if ((a1.indexOf('.') < 0 || a1.slice(0, a1.indexOf('.')) != cgroup) && cgrouppos != -1) {
                optionsDef3[cgrouppos] += ";" + compGroupBits(cgrouppos+1, optionsDef3.length-1);
                cgrouppos = -1;
            }
            if (a1.indexOf('.') >= 0 && a1.slice(0, a1.indexOf('.')) != cgroup) {
                cgroup = a1.slice(0, a1.indexOf('.'));
                cgrouppos = optionsDef3.length;
                optionsDef3.push("g;"+cgroup);
            }
            optionsDef3.push(optionsDef2[i]);
        }
        if (cgrouppos != -1) optionsDef3[cgrouppos] += ";" + compGroupBits(cgrouppos+1, optionsDef3.length-1);
        var winbody = clearElement('winbody'), group = '', gelem = null;
        for (var i = 0; i < optionsDef3.length; i++) {
            var a = optionsDef3[i].split(';'), aid = a[1].replaceAll('.','_'), ingroup = (group != aid && gelem != null && aid.indexOf(group+'_') == 0);
            var bits = a[2];
            var labeltext = a[1].replaceAll('.',' - ') + (a[0] == 'g' ? '' : ':'), labeltext2 = '';
            for (var j = 0; j < labeltext.length; j++) {
                if (j == 0 || labeltext[j - 1] == ' ') labeltext[j] = labeltext[j].toUpperCase();
                if (j > 0 && (labeltext[j].toLowerCase() != labeltext[j] || (labeltext[j] >= '0' && labeltext[j] <= '9')) && labeltext[j - 1] != ' ' && !(labeltext[j-1] >= '0' && labeltext[j-1] <= '9')) labeltext2 += ' ';
                labeltext2 += (j == 0 || labeltext2[labeltext2.length - 1] == ' ') ? labeltext[j].toUpperCase() : labeltext[j];
            }
            var labeltext3 = labeltext2;
            var setElement = function(elem, id, bits) {
                elem.id = id;
                elem.bits = bits;
                elem.className = "hidden";
                if (ingroup) { elem.style.display = 'none'; gelem.gm.push(id); }
            }
            var insertElementColor = function(elemColor, elemInput, parent) {
                elemColor.oninput = function(e) { this.previousSibling.value = e.target.value; update(); };
                elemColor.type = 'color';
                parent.appendChild(elemColor);
                elemColor.convertColor = function() { var ctx = document.createElement('canvas').getContext('2d'); ctx.fillStyle = this.previousSibling.value; this.value = ctx.fillStyle; }
                elemInput.onchange = function() { this.nextSibling.convertColor(); update(); };
                elemColor.convertColor();
            }
            var elem1 = document.createElement('label');
            setElement(elem1, "_" + aid, bits, false);
            elem1.htmlFor = aid;
            if (ingroup) { elem1.className = 'hidden pad'; labeltext2 = labeltext2.slice(labeltext2.indexOf(' - ')+3); }
            elem1.appendChild(document.createTextNode(labeltext2));
            if (a[0] == 'g') { elem1.className = 'hidden arr pad closed'; group = aid; elem1.onclick = function() {
                var state = this.className.indexOf('open') < 0;
                this.className = state ? this.className.replace('closed','open') : this.className.replace('open','closed');
                for (var j = 0; j < this.gm.length; j++) document.getElementById(this.gm[j]).style.display = state ? '' : 'none';
            }; gelem = elem1; gelem.gm = []; }
            winbody.appendChild(elem1);

            var defaultvalue = a.length >= 4 ? (a[0] == 's' || a[0] == 'c' ? a[3] : a[3].length == 0 ? "" : JSON.parse("["+a[3]+"]")[0]) : null;
            var elem2;
            if (a[0] == 'g') {
                elem2 = document.createElement('div');
            } else  if (a[0] == 's' && a.length == 5) {
                elem2 = document.createElement('select');
                elem2.onchange = update;
                var items = a[4].split(',');
                for (var j = 0; j < items.length; j++) {
                    var elem3 = document.createElement('option');
                    var t = items[j];
                    if (t.length == 0) t = "(default)";
                    elem3.appendChild(document.createTextNode(t[0].toUpperCase() + t.slice(1)));
                    elem3.value = items[j];
                    elem3.selected = items[j] == defaultvalue;
                    elem2.appendChild(elem3);
                }
            } else {
                elem2 = document.createElement('input');
                elem2.onchange = update;
                elem2.type = a[0] == 'b' ? 'checkbox' : a[0] == 'n' ? 'number' : 'text';
                if (a[0] == 'b') elem2.checked = defaultvalue == true; else elem2.value = defaultvalue;
                if (a[0] == 'n') elem2.step = (a[4] != null ? a[4] : 1);
                if (a[0] == 'o' || a[0] == 'a') elem2.obj = true;
            }
            setElement(elem2, aid, bits);
            if (a[0] == 'c') elem2.className += ' colortext';
            if (elem2.obj && a.length == 5) elem2.className += ' objtext';
            elem2.dname = labeltext3;
            winbody.appendChild(elem2);
            if (a[0] == 'c') {
                var elem4 = document.createElement('input');
                setElement(elem4, aid+"_COLOR", bits);
                insertElementColor(elem4, elem2, winbody);
            } else if (elem2.obj && a.length == 5) {
                var elem4 = document.createElement('button');
                setElement(elem4, aid+"_BUTTON", bits);
                elem4.className += " objbutton";
                elem4.appendChild(document.createTextNode("Edit"));
                elem4.dname = labeltext3;
                elem4.fields = a[4].split(',');
                elem4.aid = aid;
                elem4.isarray = a[0] == 'a';
                winbody.appendChild(elem4);
                elem4.onclick = function() {
                    var obj = null;
                    try { obj = JSON.parse(document.getElementById(this.aid).value); } catch {};
                    var editorbody = clearElement('editorbody');
                    editorbody.style.display = null;
                    winbody.style.display = "none" ;
                    document.getElementById('okbutton').onclick = document.getElementById('closebutton').onclick = function() {
                        editorbody.aid = null;
                        editorbody.style.display = "none";
                        winbody.style.display = null;
                        document.getElementById('okbutton').onclick = document.getElementById('closebutton').onclick = function() { options(); };
                        document.getElementById('optionscaption').innerText = "Options";
                    };
                    document.getElementById('optionscaption').innerText = "Options - Edit";
                    editorbody.index = this.isarray ? 1 : null;
                    editorbody.count = this.isarray ? Math.max(1,obj != null && obj[0] != null ? obj.length : 0) : null;
                    editorbody.aid = this.aid;
                    if (this.isarray && obj != null && obj[0] != null) obj = obj[0];
                    var elem6 = document.createElement('h2');
                    elem6.appendChild(document.createTextNode(this.dname));
                    editorbody.appendChild(elem6);
                    if (this.isarray) {
                        var elem8 = document.createElement('div');
                        elem8.id = "editorbtns";
                        var elem7 = document.createElement('label');
                        elem7.id = "editorcount";
                        elem7.style.width = "auto";
                        elem7.style.margin = "2px 6px";
                        var bPrev = document.createElement('button'); bPrev.appendChild(document.createTextNode("<")); bPrev.onclick = function() { editorArr(-1); }; elem8.appendChild(bPrev);
                        var bNext = document.createElement('button'); bNext.appendChild(document.createTextNode(">")); bNext.onclick = function() { editorArr(+1); }; elem8.appendChild(bNext);
                        var bAdd = document.createElement('button'); bAdd.appendChild(document.createTextNode("Add")); bAdd.onclick = function() { editorArr(0,+1); }; elem8.appendChild(bAdd);
                        var bRemove = document.createElement('button'); bRemove.appendChild(document.createTextNode("Remove")); bRemove.onclick = function() { editorArr(0,-1); }; elem8.appendChild(bRemove);
                        elem8.appendChild(elem7);
                        editorbody.appendChild(elem8);
                        editorbody.appendChild(document.createElement('hr'));
                        editorSetBtns();
                    }

                    for (var k = 0; k < this.fields.length; k++) {
                        var f0 = this.fields[k][0], f1 = this.fields[k].slice(1).split('+')[0];
                        var selitems = (f0 == 's' && this.fields[k].indexOf('+') >= 0) ? this.fields[k].slice(1).split('+') : null;
                        var a = f1.split("."), b = [];
                        for (var j = 0; j < a.length; j++) b.push(a[j][0].toLowerCase() + a[j].slice(1));
                        f1 = b.join("_");
                        var elabel = document.createElement('label');
                        elabel.id = "EDITOR_LABEL_" + f1;
                        elabel.htmlFor = "EDITOR_CTRL_" + f1;
                        var labeltext = f1.replace("_"," - ") + ':', labeltext2 = '';
                        for (var j = 0; j < labeltext.length; j++) {
                            if (j > 0 && (labeltext[j].toLowerCase() != labeltext[j] || (labeltext[j] >= '0' && labeltext[j] <= '9')) && labeltext[j - 1] != ' ' && !(labeltext[j-1] >= '0' && labeltext[j-1] <= '9')) labeltext2 += ' ';
                            labeltext2 += (j == 0 || labeltext2[labeltext2.length - 1] == ' ') ? labeltext[j].toUpperCase() : labeltext[j];
                        }
                        elabel.appendChild(document.createTextNode(labeltext2));
                        editorbody.appendChild(elabel);
                        var ectrl = selitems != null ? document.createElement('select') : document.createElement('input');
                        ectrl.id = elabel.htmlFor;
                        ectrl.onchange = update;
                        if (selitems == null) ectrl.type = f0 == 'b' || f0 == '0' || f0 == '1'  ? 'checkbox' : f0 == 'n' || f0 == 'd' ? 'number' : 'text';
                        else for (var j = 0; j < selitems.length; j++) {
                            var eoption = document.createElement('option'), t = j == 0 ? "(default)" : selitems[j];
                            eoption.appendChild(document.createTextNode(t[0].toUpperCase() + t.slice(1)));
                            eoption.value = j == 0 ? "" : t;
                            eoption.selected = j == 0;
                            ectrl.appendChild(eoption);
                        }
                        if (ectrl.type == 'checkbox') ectrl.default = f0 == '1' ? true : f0 == '0' ? false : null;
                        if (f0 == 'o') ectrl.obj = true; else if (f0 == 'n') ectrl.step = 1; else if (f0 == 'd') ectrl.step = 0.01;
                        if (f0 == 'c') ectrl.className += ' colortext';
                        var vv = obj == null ? null : this.fields.length == 1 ? obj : b.length > 1 && obj[b[0]] != null ? obj[b[0]][b[1]]: obj[f1];
                        if (ectrl.type == 'checkbox') ectrl.checked = vv == null ? ectrl.default == true : vv == true; else ectrl.value = obj != null && vv != null ? vv : "";
                        editorbody.appendChild(ectrl);
                        if (f0 == 'n' || f0 == 'd') setupNumberInput(elabel);
                        if (f0 == 'c') {
                            var ecolor = document.createElement('input');
                            ecolor.id = "EDITOR_COLOR_" + f1;
                            insertElementColor(ecolor, ectrl, editorbody);
                        }
                    }
                };
            }
        }
        winbody.appendChild(document.createElement('hr'));
        winbody.appendChild(document.createTextNode('Read more about configuration options for this chart type in '));
        var link = document.createElement('a');
        link.id = 'olink';
        link.target = '_blank';
        link.appendChild(document.createTextNode('Google Charts Guide'));
        winbody.appendChild(link);
        winbody.appendChild(document.createTextNode('. Detailed description, default values and required format for all options are available there. Complex objects sholud be entered in JSON format - with quotes for attribute name (i.e. {"color": "red", "bold": true}). To reset all options to original values click here: '));
        var reset = document.createElement('a');
        reset.href="#";
        reset.onclick = function() { if (confirm('This action cannot be undone. Are you sure you want to reset all options?')) { generateOptions(); setupCtrls(document.getElementById('winbody')); optionFieldsFor = null; update(); } };
        reset.appendChild(document.createTextNode('RESET ALL'));
        winbody.appendChild(reset);
    }
    function editorSetBtns() {
        var editorbody = document.getElementById('editorbody');
        document.getElementById("editorcount").innerText = "Item "+editorbody.index+" / "+editorbody.count;
        var a = document.getElementById("editorbtns").children;
        a[0].disabled = editorbody.index == 1;
        a[1].disabled = editorbody.index == editorbody.count;
        a[3].disabled = editorbody.count == 1;
    }
    function editorArr(moveIndex, addCount) {
        var editorbody = document.getElementById('editorbody');
        var single = document.getElementById(editorbody.aid+"_BUTTON").fields.length == 1;
        editorbody.index = Math.max(1, Math.min(editorbody.count, editorbody.index + moveIndex));
        var obj = null;
        try { obj = JSON.parse(document.getElementById(editorbody.aid).value); } catch {}
        if (!Array.isArray(obj) || obj == null) obj = single ? [""] : [{}];
        if (editorbody.count > 1 && obj[editorbody.index-1] != null && addCount == -1) obj.splice(editorbody.index-1,1);
        if (addCount == 1) { obj.push(single ? "" : {}); editorbody.index = obj.length; }
        editorbody.count = obj.length;
        editorbody.index = Math.min(editorbody.count,Math.max(1,editorbody.index));
        var item = obj[editorbody.index-1];
        for (var i = 0; i < editorbody.children.length; i++) {
            var e = editorbody.children[i], eid = e.id.replace("EDITOR_CTRL_",""), val;
            if (e.id == eid) continue;
            if (single) val = item
            else if (eid.indexOf("_") >= 0) {
                var a = eid.split("_");
                val = item != null && item[a[0]] != null ? item[a[0]][a[1]] : null;
            } else val = item != null ? item[eid] : null;
            if (e.type == 'checkbox') e.checked = val == null ? e.default == true : val; else e.value = val == null ? "" : val;
            if (e.nextSibling && e.nextSibling.convertColor) e.nextSibling.convertColor();
        }
        editorSetBtns();
        document.getElementById(editorbody.aid).value = JSON.stringify(obj);
        update();
    }
    function setupNumberInput(labelElement) {
        labelElement.style.cursor = "col-resize";
        labelElement.onmousedown = function(e) {
            var md = e, input = document.getElementById(this.htmlFor), old = parseFloat(input.value) || 0;
            document.onmousemove = function(e) { input.value = old + (e.clientX - md.clientX) * (input.step); input.onchange(e); e.preventDefault(); }
            document.onmouseup = function() { document.onmousemove = document.onmouseup = null; }
        }
    }
    function setupCtrls(parent) {
       var labels = parent.getElementsByTagName('label');
        for (var i = 0; i < labels.length; i++) if (labels[i].htmlFor != null) document.getElementById(labels[i].htmlFor).label = labels[i];
        var inputs = parent.querySelectorAll('input[type="number"]');
        for (var i = 0; i < inputs.length; i++) setupNumberInput(inputs[i].label);
    }

    function setup() {
        generateOptions();
        setupCtrls(document);
        setsize();
    }
    var optionFieldsFor = null;
    function updateOptionFields() {
        var chtype = document.getElementById("chtype").options[document.getElementById("chtype").selectedIndex].value;
        if (optionFieldsFor == chtype) return;
        var index = document.getElementById("chtype").selectedIndex;
        var optionChildren = document.getElementById('winbody').children;
        for (var i = 0; i < optionChildren.length; i++) {
            var e = optionChildren[i];
            var visible = (e.bits & (1 << index)) != 0;
            if (visible && e.className.indexOf("hidden") >= 0) e.className = e.className.replace("hidden", "visible");
            if (!visible && e.className.indexOf("hidden") < 0) e.className = e.className.replace("visible", "hidden");
        }
        optionFieldsFor = chtype;
    }

    function updateEditor() {
        var editorbody = document.getElementById("editorbody");
        var single = editorbody.index != null && document.getElementById(editorbody.aid+"_BUTTON").fields.length == 1;
        var obj = single ? "" : {}, empty = true;
        for (var i = 0; i < editorbody.children.length; i++) {
            var e = editorbody.children[i], eid = e.id.replace("EDITOR_CTRL_","");
            if (e.id == eid) continue;
            if (e.type != 'checkbox' && (e.value == null || e.value.length == 0)) continue;
            if (e.type == 'checkbox' && e.checked == e.default) continue;
            var val = e.type == 'checkbox' ? e.checked : e.type == 'number' ? parseFloat(e.value) : e.value;
            if (e.obj) { try { val = JSON.parse(val); } catch (err) { val = ""; } }
            if (single) {
                obj = val;
            } else if (eid.indexOf("_") >= 0) {
                var a = eid.split("_");
                if (obj[a[0]] == null) obj[a[0]] = {};
                obj[a[0]][a[1]] = val;
            } else obj[eid] = val;
            empty = false;
        }
        if (editorbody.index != null) {
            var obj2 = null;
            try { obj2 = JSON.parse(document.getElementById(editorbody.aid).value); } catch {}
            if (obj2 == null || !Array.isArray(obj2)) obj2 = single ? [""] : [{}];
            if (obj2[editorbody.index-1] == null) document.getElementById(editorbody.aid).value = "";
            else {
                obj2[editorbody.index-1] = obj;
                document.getElementById(editorbody.aid).value = JSON.stringify(obj2);
            }
        } else document.getElementById(editorbody.aid).value = empty ? "" : JSON.stringify(obj);
        if (document.getElementById(editorbody.aid).value == "[\"\"]"
         || document.getElementById(editorbody.aid).value == "[{}]")
            document.getElementById(editorbody.aid).value = "";
    }
    function update() {
      var d = document;
      if (d.getElementById("editorbody").aid != null) updateEditor();
      var data = d.getElementById("data").value.trim();
      if (data.trim().length > 0 && data[0] != '[') {
          var parseValue = function(v) { var v2 = null; try { v2 = JSON.parse(v); } catch { v2 = null; } if (v2 != null) return v2; else return v || ""; }
          var dels = ",;\t|", sel = 0;
          for (var j = 1; j < dels.length; j++) if (data.indexOf(dels[j]) > 0 && (data.indexOf(dels[j]) < data.indexOf(dels[sel]) || data.indexOf(dels[sel] < 0))) sel = j;
          const objPattern = new RegExp(("(\\"+dels[sel]+"|\\r?\\n|\\r|^)(?:\"((?:\\\\.|\"\"|[^\\\\\"])*)\"|([^\\"+dels[sel]+"\"\\r\\n]*))"),"gi");
          var arrMatches = null, arrData = [[]];
          while (arrMatches = objPattern.exec(data)) {
              if (arrMatches[1].length && arrMatches[1] !== dels[sel]) arrData.push([]);
              arrData[arrData.length - 1].push(parseValue(arrMatches[2] ? arrMatches[2].replace(new RegExp( "[\\\\\"](.)", "g" ), '$1') : arrMatches[3]));
          }
          d.getElementById("data").value = data = JSON.stringify(arrData).replaceAll("],[","],\n[");
      }
      var chtype = d.getElementById("chtype").options[d.getElementById("chtype").selectedIndex].value;
      d.getElementById("olink").href = 'https://developers.google.com/chart/interactive/docs/gallery/'+chtype.toLowerCase()+'#configuration-options';
      var e = clearElement("c2");
      var div1 = d.createElement('div'), div2 = d.createElement('div'), div3 = d.createElement('div');
      div1.className = "ew";
      div1.appendChild(div2);
      e.appendChild(div1);
      var ib = d.createElement('a'); ib.id = "ib"; ib.href = "#"; ib.appendChild(d.createTextNode("Insert to Photopea"));
      div3.setAttribute("style", "position: relative;margin:0 -144px;");
      div3.appendChild(ib);
      e.appendChild(div3);
      updateOptionFields();
      var optionsObj = {}, addOption = function(id) { var value = d.getElementById(id).value; if (value && value.length > 0) optionsObj[id] = value; };
      addOption("title"); addOption("width"); addOption("height");
      var optionChildren = d.getElementById('winbody').children, optionError = null;
      for (var i = 0; i < optionChildren.length; i++) {
          var e = optionChildren[i];
          if (e.tagName != "SELECT" && e.tagName != "INPUT") continue;
          if (e.type != 'checkbox' && (e.value == null || e.value.length == 0)) continue;
          if (e.className.indexOf("hidden") >= 0) continue;
          var val = e.type == 'checkbox' ? e.checked : e.value;
          if (e.obj) { try { val = JSON.parse(val); } catch (err) { if (optionError == null) optionError = 'Unable to parse option ' + e.dname + ' ' + err.message; continue; } }
          var a = e.id.split("_"), b = optionsObj;
          for (var j = 0; j < a.length; j++) {
              if (a.length == j + 1) b[a[j]] = val;
              if (a.length >= j + 2 && b[a[j]] == null) b[a[j]] = {};
              b = b[a[j]];
          }
      }
      var finishChart = function() {
          var svg = div1;
          while (svg && svg.tagName.toUpperCase() != 'SVG') svg = svg.firstChild;
          if (!svg) return;
          svg.setAttribute("viewBox", "0 0 "+svg.getAttribute("width")+" "+svg.getAttribute("height"));
          svg.parentNode.parentNode.style = "";
          ib.onclick = function() { insertImage(svg); };
      }
      var dataObj = null;
      try { dataObj = JSON.parse(data); }
      catch (err) { drawError(div1, err.message); }
      if (dataObj != null) {
          if (optionError != null) {
              drawError(div1, optionError);
          } else {
              try { drawChart(div1, chtype, dataObj, d.getElementById("fl").checked, optionsObj, finishChart); }
              catch (err) { drawError(div1, err.message); }
          }
      }
      cont.style.display = "block";
      setsize();
      window.onresize = setsize;
      savestate();
    }

    function options() {
        var visible = document.getElementById('win').style.display == 'block';
        document.getElementById('winbody').scroll(0, 0);
        document.getElementById('win').style.display = visible ? 'none' : 'block';
    }
    function optionsHeight() {
        var win = document.getElementById('win');
        var state = win.style.height == '';
        win.style.height = state ? win.getBoundingClientRect().height + 'px' : '';
        setsize();
    }

    var state = null;
    function savestate() {
      try { if (typeof window.sessionStorage !== 'undefined') {
        var obj = { data:document.getElementById("data").value,
                    chtype:document.getElementById("chtype").selectedIndex,
                    title:document.getElementById("title").value,
                    width:document.getElementById("width").value,
                    height:document.getElementById("height").value,
                    fl:document.getElementById("fl").checked }
        var optionChildren = document.getElementById('winbody').children;
        for (var i = 0; i < optionChildren.length; i++) {
            var e = optionChildren[i];
            if (e.tagName != "SELECT" && e.tagName != "INPUT") continue;
            obj[e.id] = e.type == 'checkbox' ? e.checked : e.value;
        }
        var s = JSON.stringify(obj);
        if (state != s) { state = s; window.sessionStorage.setItem("googlecharts_state", state); }
      } } catch {}
    }
    function loadstate() {
      try { if (typeof window.sessionStorage !== 'undefined') {
        if (state = window.sessionStorage.getItem("googlecharts_state")) {
            var s = JSON.parse(state);
            document.getElementById("data").value = s.data;
            document.getElementById("chtype").selectedIndex = s.chtype;
            document.getElementById("title").value = s.title;
            document.getElementById("width").value = s.width;
            document.getElementById("height").value = s.height;
            document.getElementById("fl").checked = s.fl;
            var optionChildren = document.getElementById('winbody').children;
            for (var i = 0; i < optionChildren.length; i++) {
                var e = optionChildren[i];
                if (e.tagName != "SELECT" && e.tagName != "INPUT") continue;
                if (e.type == 'checkbox') e.checked = s[e.id]; else e.value = s[e.id];
            }
        }
      } } catch {}
    }
    </script>
  </head>
  <body>
    <div id="topbar">

<label for="chtype">Type:</label><select id="chtype" onchange="update()">
        <option value="AreaChart">Area Chart</option>
        <option value="BarChart">Bar Chart</option>
        <option value="BubbleChart">Bubble Chart</option>
        <option value="CandlestickChart">Candlestick Chart</option>
        <option value="ColumnChart">Column Chart</option>
        <option value="ComboChart">Combo Chart</option>
        <option value="Histogram">Histogram</option>
        <option value="LineChart">Line Chart</option>
        <option value="PieChart" selected>Pie Chart</option>
        <option value="ScatterChart">Scatter Chart</option>
        <option value="SteppedAreaChart">Stepped Area Chart</option>
      </select> <button onclick="options();">Options...</button>
<br/><label for="title">Title:</label><input type="text" id="title" value="What country are you from?" onchange="update()"></input>
<br/><label for="width">Width:</label><input type="number" step="1" id="width" value="600" onchange="update()"></input>
<label for="height" style="width:50px;padding-left:33px">Height:</label><input type="number" step="1" id="height" value="300" onchange="update()"></input>

      <div style="position:absolute;bottom:0;"><label for="data">Data:</label></div>
<div style="position:absolute;bottom:0;right:0;line-height: 23px;">
<input class="" type="checkbox" id="fl" onchange="update()" checked><label for="fl" style="width:auto;">First row contains labels</label>
      </div>
</div>

<textarea id="data" onchange="update()" spellcheck="false" style="height:114px;">
[["Country","2021","2020","2019","2018"],
["United States",21.94,17.70,17.32,20.26],
["India",14.85,10.43,12.62,11.22],
["United Kingdom",5.54,3.05,3.42,3.55],
["Indonesia",4.48,5.27,3.36,1.91],
["Brazil",4.09,7.55,5.22,3.50],
["Philippines",3.02,3.90,3.21,3.56]]</textarea>
<hr id="splitter"/>
    <div id="cont"><div id="c2" style="height:150px"></div></div>

    <div id="win">
        <div class="head" ondblclick="optionsHeight();"><span id="optionscaption" class="label">Options</span><span id="closebutton" class="cross" onclick="options();"></span></div>
        <div class="body" id="winbody"></div>
        <div class="body" id="editorbody" style="display:none;"></div>
        <div style="margin:0 12px;"><button id="okbutton" onclick="options();" style="width:100%">OK</button></div>
    </div>

    <script>setup();</script>

  </body>
</html>

